<!doctype html><html lang=en><script async src="https://www.googletagmanager.com/gtag/js?id=UA-12771589-3"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[];gtag("js",new Date);gtag("config","UA-12771589-3")</script><meta charset=utf-8><meta name=viewport content="width=device-width, initial-scale=1.0, maximum-scale=1"><meta name=description content=""><meta name=author content="Zachary Snow"><title>C# Extension Methods in your own Library</title><base href=../../ ><link href="https://fonts.googleapis.com/css?family=Open+Sans" rel=stylesheet><link rel=stylesheet type=text/css href=css/style.css><link rel=alternate type=application/rss+xml title="The Blog of Zachary Snow" href=feed.rss><div class=wrap><header id=header><div class=container><div class=social><a href=http://twitter.com/smack0007 class=twitter title=Twitter><span class="fab fa-twitter"></span></a> <a href=http://github.com/smack0007 class=github title=Github><span class="fab fa-github"></span></a> <a href=feed.rss class=rss title=RSS><span class="fas fa-rss"></span></a></div><h1><a href=index.html title=Home>The Blog of Zachary Snow</a></h1></div></header><aside id=sidebar><nav><a href=index.html class=sidebar-nav-item>Home</a> <a href=about.html class=sidebar-nav-item>About</a></nav></aside><div id=hamburger onclick=toggleHamburger(this)><div class=bar1></div><div class=bar2></div><div class=bar3></div></div><script>function toggleHamburger(n){n.classList.toggle("active");document.getElementById("sidebar").classList.toggle("active")}</script><main class=container><div class=posts><div class=post><h2><a href=blog/2010/csharp-extension-methods-in-your-own-library.html>C# Extension Methods in your own Library</a></h2><div class=meta><span class=date><span class="fas fa-calendar-alt"></span>March 08, 2010</span> <span class=category><span class="fas fa-folder"></span>.NET</span> <span class=tags><span class="fas fa-tags"></span>C#, Extension Methods</span></div><div class=content><p>Normally I use extension methods in C# to extend a library that I did not write and therefore I have no control over. There are situations where it makes sense to use extension methods for a library that you yourself are writing.<p>For example, when you have interfaces in your library. You want to keep the number of methods in that interface as low as possible so that classes implementing the interface don't have to do a lot of heavy lifting. This means cutting out methods in an interface that are for the most part just syntactic sugar for another method in the interface.
<pre><code class=language-c#><span class=keyword>public</span> <span class=keyword>interface</span> IServiceContainer
{
    <span class=keyword>void</span> AddService(Type type, Object provider);
    <span class=keyword>object</span> GetService(Type type);
}

<span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>class</span> IServiceContainerExtensions
{
    <span class=keyword>public</span> <span class=keyword>static</span> <span class=keyword>void</span> AddService&amp;lt;T&amp;gt;(<span class=keyword>this</span> IServiceContainer services, <span class=keyword>object</span> provider)
    {
        services.AddService(<span class=keyword>typeof</span>(T), provider);
    }

    <span class=keyword>public</span> <span class=keyword>static</span> T GetService&amp;lt;T&amp;gt;(<span class=keyword>this</span> IServiceContainer services) <span class=keyword>where</span> T : <span class=keyword>class</span>
    {
        <span class=keyword>return</span> services.GetService(<span class=keyword>typeof</span>(T)) <span class=keyword>as</span> T;
    }

    <span class=keyword>public</span> <span class=keyword>static</span> T GetRequiredService&amp;lt;T&amp;gt;(<span class=keyword>this</span> IServiceContainer services) <span class=keyword>where</span> T : <span class=keyword>class</span>
    {
        T service = services.GetService(<span class=keyword>typeof</span>(T)) <span class=keyword>as</span> T;

        <span class=keyword>if</span>(service == <span class=keyword>null</span>)
            <span class=keyword>throw</span> <span class=keyword>new</span> ServiceNotFoundException(<span class=keyword>typeof</span>(T));

        <span class=keyword>return</span> service;
    }
}</code></pre><p>All of the methods in IServiceContainerExtensions are just helper methods for method in IServiceContainer. By making them extension methods in our own library though, we've made the barrier to entry lower. Other people can implement the interface and in a sense "inherit" the helper methods as well.</div></div></div><div class=clear></div></main></div>